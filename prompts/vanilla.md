# Build Command Prompt

以下の手順に従って、ソースコードのドキュメント化を行ってください。

## 実行するbuildコマンド

`@policy.md`に記載された要件に従い、以下の処理を順次実行してください：

### 1. PDF参考資料のOCR処理

まず、`@process_pdfs.sh`スクリプトを使用して、`refs/materials/`内のPDFファイルをすべてMarkdown化してください。

```bash
./utils/process_pdfs.sh
```

このスクリプトは以下を自動実行します：
- Python仮想環境の作成・アクティベート
- 必要なパッケージ（mistralai, python-dotenv）のインストール
- `refs/materials/`内のすべてのPDFファイルのOCR処理
- 結果を`refs/build/`ディレクトリに`{ファイル名}_ocr_result.md`として保存

### 2. OCR結果の整形

`refs/build/`に生成されたMarkdownファイルを読み込み、以下の整形処理を行ってください：

- 不要な改行や空白の除去
- セクション見出しの統一（# ## ### の階層構造）
- 表やリストの整形
- 図表キャプションの整理
- 目次の生成

整形されたファイルは同じく`refs/build/`に`{ファイル名}_formatted.md`として保存してください。

### 3. ソースコードの解析

`src/`ディレクトリ内のソースコードを解析し、以下の情報を抽出してください：

- ファイル構造とディレクトリ階層
- 各ファイルの概要と役割
- 関数・クラス・メソッドの定義と説明
- 依存関係とインポート構造
- 主要なアルゴリズムやロジック

### 4. 統合ドキュメントの生成

上記の情報を統合して、`docs/`ディレクトリに以下のドキュメントを生成してください：

#### 4.1 メインドキュメント（`docs/README.md`）
- プロジェクト概要
- アーキテクチャの説明
- 主要コンポーネントの紹介
- 参考資料からの重要な情報の抜粋

#### 4.2 API ドキュメント（`docs/api/`）
- 各モジュール・クラス・関数の詳細説明
- 使用例とサンプルコード
- パラメータと戻り値の説明

#### 4.3 設計ドキュメント（`docs/design/`）
- システム設計の詳細
- `refs/build/`の参考資料を参照した設計根拠
- アーキテクチャ図（可能であれば）

#### 4.4 使用方法ガイド（`docs/usage/`）
- セットアップ手順
- 基本的な使用方法
- 応用例とベストプラクティス

### 5. 品質確認

生成されたドキュメントについて以下を確認してください：

- すべてのリンクが正しく機能すること
- Markdownの構文が正しいこと
- 参考資料からの情報が適切に引用されていること
- ソースコードとの整合性が取れていること

## 実行時の注意事項

1. **前提条件の確認**
   - `utils/.env`にMISTRALAI_API_KEYが設定されていること
   - `refs/materials/`にPDFファイルが配置されていること
   - `any_src/`にソースコードが存在すること

2. **エラーハンドリング**
   - 各ステップでエラーが発生した場合は、詳細なエラーメッセージを出力
   - 可能な限り処理を継続し、最終的に成功・失敗の結果を報告

3. **進捗報告**
   - 各ステップの開始・完了時に進捗を報告
   - 処理時間の長いタスクでは中間報告を行う

4. **出力の整理**
   - 生成されたファイルの一覧を最後に表示
   - ファイルサイズや行数などの統計情報も含める

## 期待される最終成果物

このbuildコマンドの実行により、以下が完成することを期待します：

- `refs/build/`: OCR処理・整形済みの参考資料
- `docs/README.md`: プロジェクト全体の概要ドキュメント
- `docs/api/`: 詳細なAPIドキュメント
- `docs/design/`: 設計ドキュメント
- `docs/usage/`: 使用方法ガイド

これらのドキュメントにより、プロジェクトの理解と利用が容易になることを目指してください。
